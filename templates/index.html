<!doctype html>
<html lang="en">
<head>
    <title>Insurance Fraud Prediction</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon"
        href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRFlXX7oHNqLB-53EK9kgKRGESln51QaD3h1bsIFTjpZevbniuoiaIwTR8l9sEz8b4ScPg&usqp=CAU" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
    <style>
        body{font-family:Lato,'Helvetica Neue',Helvetica,Arial,sans-serif;}
        h1,h2,h3,h4,h5,h6{font-family:Lato,'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:700;}
        .title{color:#273582;}
        #fetch{cursor:pointer;}
        #stopfetch{cursor:pointer;}
        #fetch:hover,#fetch:active,#fetch:focus,#stopfetch:hover,#stopfetch:active,#stopfetch:focus{background-color:#ff7f00;border-color:#ff7f00;}
        footer.footer{padding-top:0.5rem;padding-bottom:0.5rem;background-color: #e3e8ed!important;}
        footer a{color:#000;font-weight:500;text-decoration:none;}
        footer li a:hover{color:orange;}
        footer li i{color:#363e75;}
        footer li i:hover{color:orange;}
        .navbar-light .navbar-brand{color: rgba(0,0,0,.9);}
        .navbar-light .navbar-brand {margin-left: auto;margin-right: auto;}
        .container-fluid{width:90%;}
        .load{
            height:100%;
            background-color:#ffffffbe;
            position:absolute;
            width:100%;
            z-index:1000;
            display:none;
        }
        .loader {
          border: 10px solid #f3f3f3;
          border-radius: 50%;
          border-top: 10px solid #3498db;
          width: 30px;
          height: 30px;
          margin-left:auto;
          margin-right:auto;
          margin-top:30%;
          -webkit-animation: spin 2s linear infinite; /* Safari */
          animation: spin 2s linear infinite;
        }

        /* Safari */
        @-webkit-keyframes spin {
          0% { -webkit-transform: rotate(0deg); }
          100% { -webkit-transform: rotate(360deg); }
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        @media (min-width:768px){
            header.masthead{
                padding-top:4rem;
                padding-bottom:4rem;
            }
            header.masthead h1{
                font-size:3rem;
            }
        }
        .res-container{}
        .result-box{width:80%;margin-left:auto;margin-right:auto;height: 260px;padding:10px;overflow-y: auto;}
        #loading {
            position: fixed;
            left: 0px;
            top: 0px;
            width: 100%;
            height: 100%;
            z-index: 9999999999;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.7);
        }
        .loader {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #363e75;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            left: 50%;
            margin-left: -4em;
            display: block;
            animation: spin 2s linear infinite;
        }
        .loader,
        .loader:after {
            display: block;
            position: absolute;
            top: 50%;
            margin-top: -4.05em;
        }
        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
        .footer{position:absolute;bottom:0px;width:100%;}
        #datafetch_form{padding:0px 40px;}
        .json-result{}
        .result-box p{text-align:left;}
    </style>
</head>

<body>

    <nav class="navbar navbar-light bg-light static-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="https://presidencyuniversity.in/"><img src="https://presidencyuniversity.in/content/uploads/2018/02/presidency-university-logo.png"/></a>
        </div>
    </nav>

    <section class="testimonials text-center">
        <div class="container-fluid">
            <h4 class="my-4 title">Insurance Fraud Prediction</h4>
            <div class="row">
                <div class="col-md-6 col-xs-12">
                    <br/>
                    <form method="post" id="datafetch_form" enctype="multipart/form-data">
                        <div class="form-group files color">
                            <input type="text" name = "csvfile" id="csvfile" class="form-control" placeholder="Enter file path." required>
                        </div>
                        <div class=""><button class="form-control btn-primary" id="customfile">Custom File Predict</button></div>
                        <br/><center><b>Or</b></center><br/>
                        <button class="form-control btn-primary mb-5" id="defaultfile" data-path = "Prediction_Batch_files">
                            Default File Predict
                        </button>
                    </form>
                    
                    <hr>
                    <h5 class="title">Train New Models</h5>
                    <div style="padding:0px 40px;">
                        <div class="form-group">
                            <input type="text" id="trainpath" class="form-control" placeholder="Enter Training Folder Path" 
                                value="Enter Path to Training Batch Files.">
                        </div>
                        <button class="form-control btn-warning mb-5" id="trainbtn">
                            Train Model
                        </button>
                    </div>
                    </div>
                <div class="res-container  col-md-6 col-xs-12">
                    <div class="result-box shadow rounded-lg">
                        <h6 class="title">Results</h6>
                        <div class="json-result">

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-6 h-100 text-center my-auto mx-auto">
                    <ul class="list-inline mb-1">Made by :
                        <li class="list-inline-item">Jyoti Choudhary</li>
                    </ul>
                    <ul class="list-inline mb-1">IGDTUW
                        <li></li>
                        <li class="list-inline-item">ML PROJECT</li>
                    </ul>
                    <p class="text-muted small mb-2 mb-lg-0"></p>
                </div>
            </div>
        </div>
    </footer>


    <div id="loading"><div class="loader"></div></div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function(){
            $('#loading').hide();
            $("#customfile").click(function(e){
                e.preventDefault();
                $('#loading').show();
                var path = $("#csvfile").val();
                $.ajax({
                    url : "/predict",
                    type: "POST",
                    data: {filepath:path},
                    success: function(response){
                        $(".json-result").html('<p>"Prediction File created at !!!Prediction_Output_File/Predictions.csvand few of the predictions are"</p><pre>' + response + '</pre>');
                        $('#loading').hide();
                    }
                });
            });
            $("#defaultfile").click(function(e){
                e.preventDefault();
                $('#loading').show();
                var path = $(this).attr("data-path");
                $.ajax({
                    url : "/predict",
                    type: "POST",
                    data: {filepath:path},
                    success: function(response){
                        $(".json-result").html('<p>Prediction File created Successfully !!!</p><pre>' + response + '</pre>');
                        $('#loading').hide();
                    }
                });

            });

            // NEW TRAINING SCRIPT
            $("#trainbtn").click(function(e){
                e.preventDefault();
                $('#loading').show();
                var path = $("#trainpath").val();
                $.ajax({
                    url : "/train",
                    type: "POST",
                    contentType: 'application/json', 
                    data: JSON.stringify({ "folderPath": path }),
                    success: function(response){
                        $(".json-result").html('<p>Training Status:</p><pre>' + response + '</pre>');
                        $('#loading').hide();
                    },
                    error: function(xhr){
                        $(".json-result").html('<p>Error:</p><pre>' + xhr.responseText + '</pre>');
                        $('#loading').hide();
                    }
                });
            });
        });
    </script>
</body>

</html>